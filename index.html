<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO Meta Tags -->
    <title>فروشگاه آنلاین | خرید محصولات با کیفیت و قیمت مناسب</title>
    <meta name="description" content="فروشگاه آنلاین با محصولات متنوع، قیمت مناسب و ارسال سریع. خرید آسان و امن با پشتیبانی 24/7">
    <meta name="keywords" content="فروشگاه آنلاین, خرید اینترنتی, محصولات, قیمت مناسب, ارسال سریع, پشتیبانی">
    <meta name="author" content="فروشگاه ساده">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph Meta Tags (برای شبکه‌های اجتماعی) -->
    <meta property="og:title" content="فروشگاه آنلاین | خرید محصولات با کیفیت">
    <meta property="og:description" content="فروشگاه آنلاین با محصولات متنوع و قیمت مناسب">
    <meta property="og:image" content="https://your-domain.com/images/logo.png">
    <meta property="og:url" content="https://your-domain.com">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="fa_IR">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="فروشگاه آنلاین | خرید محصولات با کیفیت">
    <meta name="twitter:description" content="فروشگاه آنلاین با محصولات متنوع و قیمت مناسب">
    <meta name="twitter:image" content="https://your-domain.com/images/logo.png">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://your-domain.com">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    
    <!-- Preconnect to external domains -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="live-notifications.css" rel="stylesheet">
    <!-- RTL CSS -->
    <link rel="stylesheet" href="rtl.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css">
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'GA_MEASUREMENT_ID');
        
        // Track page views
        gtag('event', 'page_view', {
            page_title: document.title,
            page_location: window.location.href
        });
        
        // Track user engagement
        gtag('event', 'user_engagement', {
            engagement_time_msec: 1000
        });
    </script>
    
    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Store",
        "name": "فروشگاه ساده",
        "description": "فروشگاه آنلاین با محصولات متنوع و قیمت مناسب",
        "url": "https://your-domain.com",
        "logo": "https://your-domain.com/images/logo.png",
        "address": {
            "@type": "PostalAddress",
            "addressCountry": "IR"
        },
        "contactPoint": {
            "@type": "ContactPoint",
            "contactType": "customer service",
            "availableLanguage": "Persian"
        },
        "sameAs": [
            "https://instagram.com/your-shop",
            "https://telegram.me/your-shop"
        ]
    }
    </script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-store me-2"></i>
                فروشگاه ساده
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/"><i class="fas fa-home me-1"></i><span data-i18n="navigation.home">خانه</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/courses.html"><i class="fas fa-graduation-cap me-1"></i><span data-i18n="navigation.courses">دوره‌ها</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/videos.html"><i class="fas fa-video me-1"></i><span data-i18n="navigation.videos">ویدئوها</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/whatsapp-messenger.html">
                            <i class="fas fa-comments me-1"></i>پیام‌رسان WhatsApp
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/test-payment-page.html?productId=1">
                            <i class="fas fa-credit-card me-1"></i>پرداخت تستی
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/support.html">
                            <i class="fas fa-headset me-1"></i><span data-i18n="navigation.support">پشتیبانی</span>
                        </a>
                    </li>
                </ul>
                <ul class="navbar-nav">
                    <!-- Language Selector -->
                    <li class="nav-item me-2">
                        <div class="language-selector dropdown">
                            <button class="btn btn-outline-light dropdown-toggle" type="button" data-bs-toggle="dropdown">
                                <i class="fas fa-globe me-1"></i>
                                <span data-i18n="common.language">زبان</span>
                            </button>
                            <ul class="dropdown-menu">
                                <li>
                                    <a class="dropdown-item" href="#" data-language="fa">
                                        <span class="flag-icon" style="background: linear-gradient(to bottom, #239f56 0%, #239f56 50%, #da0000 50%, #da0000 100%);"></span>
                                        فارسی
                                    </a>
                                </li>
                                <li>
                                    <a class="dropdown-item" href="#" data-language="en">
                                        <span class="flag-icon" style="background: linear-gradient(to bottom, #b22234 0%, #b22234 50%, #ffffff 50%, #ffffff 100%);"></span>
                                        English
                                    </a>
                                </li>
                                <li>
                                    <a class="dropdown-item" href="#" data-language="ar">
                                        <span class="flag-icon" style="background: linear-gradient(to bottom, #000000 0%, #000000 33%, #ffffff 33%, #ffffff 66%, #006c35 66%, #006c35 100%);"></span>
                                        العربية
                                    </a>
                                </li>
                                <li>
                        <a class="dropdown-item" href="#" data-language="fr">
                            <span class="flag-icon" style="background: linear-gradient(to right, #002395 0%, #002395 33%, #ffffff 33%, #ffffff 66%, #ed2939 66%, #ed2939 100%);"></span>
                            Français
                        </a>
                    </li>
                    <li>
                        <a class="dropdown-item" href="#" data-language="de">
                            <span class="flag-icon" style="background: linear-gradient(to bottom, #000000 0%, #000000 33%, #dd0000 33%, #dd0000 66%, #ffce00 66%, #ffce00 100%);"></span>
                            Deutsch
                        </a>
                    </li>
                </ul>
                        </div>
                    </li>
                    <li class="nav-item" id="authLinks">
                        <a class="nav-link" href="/auth.html"><i class="fas fa-sign-in-alt me-1"></i><span data-i18n="auth.login">ورود</span></a>
                    </li>
                    <li class="nav-item d-none" id="profileLink">
                        <a class="nav-link" href="/profile.html"><i class="fas fa-user me-1"></i><span data-i18n="navigation.profile">پروفایل</span></a>
                    </li>
                    <li class="nav-item d-none" id="logoutBtn">
                        <a class="nav-link" href="#" onclick="logout()"><i class="fas fa-sign-out-alt me-1"></i><span data-i18n="auth.logout">خروج</span></a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mt-4">
        <!-- Hero Section -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="bg-light rounded p-4 text-center">
                    <h1 class="display-4 mb-3">به فروشگاه ما خوش آمدید</h1>
                    <p class="lead">بهترین محصولات را با بهترین قیمت از ما خریداری کنید</p>
                </div>
            </div>
        </div>

        <!-- Products and Cart Section -->
        <div class="row">
            <!-- Products Section -->
            <div class="col-lg-8 col-md-7 mb-4">
                <div class="card">
                    <div class="card-header">
                        <h2 class="h4 mb-0"><i class="fas fa-box me-2"></i>محصولات</h2>
                    </div>
                    <div class="card-body">
                        <div class="row" id="products">
                            <!-- Products will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Cart Section -->
            <div class="col-lg-4 col-md-5 mb-4">
                <div class="card">
                    <div class="card-header">
                        <h3 class="h5 mb-0"><i class="fas fa-shopping-cart me-2"></i>سبد خرید</h3>
                    </div>
                    <div class="card-body">
                        <div id="cart-section">
                            <div id="cart-items">
                                <!-- Cart items will be displayed here -->
                            </div>
                            <div class="mt-3">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <strong>مجموع:</strong>
                                    <span id="total-amount">0 تومان</span>
                                </div>
                                <a href="payment.html" id="pay-btn" class="btn btn-success w-100" onclick="return validateCart()">
                                    <i class="fas fa-credit-card me-2"></i>پرداخت
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Services Section -->
        <div class="row mt-5">
            <div class="col-12">
                <h2 class="text-center mb-4">خدمات ما</h2>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-shopping-cart fa-3x text-primary mb-3"></i>
                        <h5 class="card-title">فروشگاه آنلاین</h5>
                        <p class="card-text">خرید آسان و مطمئن محصولات مختلف</p>
                        <a href="#products" class="btn btn-primary" onclick="scrollToProducts()">شروع خرید</a>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-graduation-cap fa-3x text-success mb-3"></i>
                        <h5 class="card-title">دوره‌های آموزشی</h5>
                        <p class="card-text">دوره‌های تخصصی در زمینه‌های مختلف</p>
                        <a href="/courses.html" class="btn btn-success">مشاهده دوره‌ها</a>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-play-circle fa-3x text-danger mb-3"></i>
                        <h5 class="card-title">ویدئوها</h5>
                        <p class="card-text">ویدئوهای آموزشی و سرگرم‌کننده</p>
                        <a href="/videos.html" class="btn btn-danger">مشاهده ویدئوها</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-dark text-light py-4 mt-5">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5>فروشگاه ساده</h5>
                    <p>بهترین محصولات با بهترین قیمت</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <h5>ارتباط با ما</h5>
                    <p>ایمیل: info@shop.com</p>
                    <p>تلفن: ۰۲۱-۱۲۳۴۵۶۷۸</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="analytics.js"></script>
    <script src="script.js"></script>
    <script src="components/NotificationWidget.js"></script>
    
    <!-- Chat Widget -->
    <link rel="stylesheet" href="chat-widget.css">
    <script src="/socket.io/socket.io.js"></script>
    <script src="auth-manager.js"></script>
    <script src="chat-widget.js"></script>
    <script>
    // مدیریت سبد خرید در LocalStorage
    let cart = JSON.parse(localStorage.getItem('cart') || '[]');
    function saveCart() {
        localStorage.setItem('cart', JSON.stringify(cart));
    }
    function renderCart() {
        const cartItems = document.getElementById('cart-items');
        const payBtn = document.getElementById('pay-btn');
        
        if (cart.length === 0) {
            cartItems.innerHTML = '<div class="text-muted">سبد خرید خالی است.</div>';
            document.getElementById('total-amount').textContent = '0 تومان';
            // Disable payment button when cart is empty
            if (payBtn) {
                payBtn.classList.add('disabled');
                payBtn.style.pointerEvents = 'none';
                payBtn.style.opacity = '0.6';
            }
            return;
        }
        
        // Enable payment button when cart has items
        if (payBtn) {
            payBtn.classList.remove('disabled');
            payBtn.style.pointerEvents = 'auto';
            payBtn.style.opacity = '1';
        }
        let total = 0;
        cartItems.innerHTML = cart.map((item, i) => {
            total += item.price * item.qty;
            return `<div class='d-flex align-items-center justify-content-between border-bottom py-2'>
                <div>
                    <img src='${item.image}' style='width:40px;height:40px;object-fit:cover;border-radius:6px;'>
                    <span class='ms-2'>${item.name}</span>
                </div>
                <div>
                    <span class='badge bg-primary'>${item.qty}</span>
                    <span class='ms-2 text-success fw-bold'>${item.price.toLocaleString()} تومان</span>
                    <button class='btn btn-sm btn-danger ms-2' onclick='removeFromCart(${i})'><i class='fas fa-trash'></i></button>
                </div>
            </div>`;
        }).join('');
        document.getElementById('total-amount').textContent = total.toLocaleString() + ' تومان';
    }
    function addToCart(product) {
        const idx = cart.findIndex(p => p.id === product.id);
        if (idx > -1) {
            cart[idx].qty++;
        } else {
            cart.push({ ...product, qty: 1 });
        }
        saveCart();
        renderCart();
    }
    function removeFromCart(idx) {
        cart.splice(idx, 1);
        saveCart();
        renderCart();
    }
    // دریافت محصولات از سرور
    async function loadProducts() {
        const res = await fetch('/api/products');
        const data = await res.json();
        if (data.success) {
            const productsDiv = document.getElementById('products');
            productsDiv.innerHTML = data.products.map(p => `
                <div class='col-md-6 col-lg-4 mb-4'>
                    <div class='card h-100'>
                        <img src='${p.image}' class='card-img-top' style='height:180px;object-fit:cover;'>
                        <div class='card-body d-flex flex-column'>
                            <h5 class='card-title'>${p.name}</h5>
                            <p class='card-text small text-muted'>${p.description || ''}</p>
                            <div class='mt-auto'>
                                <div class='fw-bold text-success mb-2'>${p.price.toLocaleString()} تومان</div>
                                <button class='btn btn-primary w-100' onclick='addToCart(${JSON.stringify({id:p.id,name:p.name,price:p.price,image:p.image})})'>
                                    <i class='fas fa-cart-plus me-1'></i>افزودن به سبد خرید
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }
    }
    loadProducts();
    renderCart();
    
    // Function to scroll to products section
    function scrollToProducts() {
        const productsSection = document.getElementById('products');
        if (productsSection) {
            productsSection.scrollIntoView({ 
                behavior: 'smooth',
                block: 'start'
            });
        }
    }
    
    // Function to validate cart before payment
    function validateCart() {
        if (cart.length === 0) {
            alert('سبد خرید شما خالی است. لطفاً ابتدا محصولی به سبد خرید اضافه کنید.');
            return false;
        }
        return true;
    }
    </script>
    <script src="live-notifications.js"></script>
    <!-- i18n Script -->
    <script src="i18n-browser.js"></script>
</body>
</html>
